<ActionBar class="action-bar" flat="true" title="Firmware Updates">
  <NavigationButton android.systemIcon="ic_menu_back" tap="onNavBtnTap"></NavigationButton>

  <ActionItem icon="res://navigation/menu" android:visibility="collapsed" (tap)="onDrawerButtonTap()" ios.position="left"></ActionItem>
</ActionBar>

<RadSideDrawer #drawer ios:showOverNavigation="true" android:showOverNavigation="false" [drawerTransition]="sideDrawerTransition">

  <StackLayout tkDrawerContent>
    <MyDrawer [selectedPage]="'OTA'"></MyDrawer>
  </StackLayout>

  <StackLayout tkMainContent class="page page-content">
    <ScrollView class="hero" height="70%">
    <StackLayout class="page page-content">
      <Label class="title"
             [text]="ptConnected ? initialTitleText : connectedTitleText"
             textWrap="true"></Label>

      <FlexboxLayout>
        <Button class="hero"
                [visibility]="updating ? 'collapse' : 'visible'"
                width="50%"
              text="Refresh Device List"
              margin="5, 10, 5, 10"
              (tap)="onRefreshDeviceList()"></Button>
      <Button class="hero"
                [width]="updating ? '100%' : '50%'"
              [text]="updatingButtonText"
              margin="5, 10, 5, 10"
              (tap)="onStartOtaUpdate()"></Button>
      </FlexboxLayout>

      //StackLayout in contains progress views for updates
      <StackLayout #otaProgressView padding="5" orientation="vertical">
        //SmartDrive OTAs
        <StackLayout class="ota" *ngFor="let sd of smartDriveOTAs._array">
          <GridLayout class="otaInfo" rows="auto" columns="auto, *">
            <Label col="0" class="otaLabel" text="SmartDrive"></Label>
            <Label col="1" class="percentageLabel" [text]="sd.otaProgressToString()"></Label>
          </GridLayout>
          <Progress [value]="sd.otaProgress" maxValue="100" class="progress"></Progress>
          <GridLayout class="otaInfo" rows="auto, auto, *" columns="auto, *">
            <Label col="0" class="otaLabel" [text]="sd.address"></Label>
            <TextView col="0" row="1" editable="false" class="otaState" textDecoration="none" [text]="sd.otaStateToString()"></TextView>
            <WrapLayout orientation="horizontal" horizontalAlignment="right" rowSpan="3" col="1">
              <Button *ngFor="let action of sd.otaActions" class="otaAction" [text]="action" (tap)="sd.onOTAActionTap(action)"></Button>
            </WrapLayout>
          </GridLayout>
        </StackLayout>
        //PushTracker OTAs
        <StackLayout class="ota" *ngFor="let pt of pushTrackerOTAs._array">
          <GridLayout class="otaInfo" rows="auto" columns="auto, *">
            <Label col="0" class="otaLabel" text="PushTracker"></Label>
            <Label col="1" class="percentageLabel" [text]="pt.otaProgressToString()"></Label>
          </GridLayout>
          <Progress [value]="pt.otaProgress" maxValue="100" class="progress"></Progress>
          <GridLayout class="otaInfo" rows="auto, auto, *" columns="auto, *">
            <Label col="0" class="otaLabel" [text]="pt.address"></Label>
            <TextView col="0" row="1" editable="false" class="otaState" textDecoration="none" [text]="pt.otaStateToString()"></TextView>
            <WrapLayout orientation="horizontal" horizontalAlignment="right" rowSpan="3" col="1">
              <Button *ngFor="let action of pt.otaActions" class="otaAction" [text]="action" (tap)="pt.onOTAActionTap(action)"></Button>
            </WrapLayout>
          </GridLayout>
        </StackLayout>
      </StackLayout>

    </StackLayout>
    </ScrollView>


    <slides loop="true" pageIndicators="true" class="featuresLayout" height="30%" width="100%">
      <slide *ngFor="let desc of otaDescription" class="featuresLayout">
        <Label class="features" textWrap="true" [text]="desc"></Label>
      </slide>
    </slides>
  </StackLayout>
</RadSideDrawer>
