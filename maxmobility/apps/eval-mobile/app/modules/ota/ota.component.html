<ActionBar class="action-bar" flat="true" title="Firmware Updates">
  <NavigationButton ios:visibility="collapsed"></NavigationButton>
  <ActionItem icon="res://navigation/menu" android:visibility="collapsed" (tap)="onDrawerButtonTap()" ios.position="left"></ActionItem>
  <!-- <Label class="action-bar-title" text="OTA Update"></Label> -->
</ActionBar>

<RadSideDrawer #drawer showOverNavigation="true" [drawerTransition]="sideDrawerTransition">

  <StackLayout tkDrawerContent>
    <MyDrawer [selectedPage]="'OTA'"></MyDrawer>
  </StackLayout>

  <ScrollView class="hero" #scrollView tkMainContent>
    <GridLayout columns="*" rows="auto,auto,auto,auto, *" class="page page-content">

      //StackLayout in row 0 contains connectivity buttons for BT
      <StackLayout col="0" row="0" orientation="vertical" verticalAlignment="center" margin="20,0,0,0">
        <StackLayout orientation="horizontal" horizontalAlignment="center" height="75" >
          <Button [class]="connected ? 'fa hero' : 'fa grayed'"
		  text="PushTracker"
		  margin="0, 25, 0, 15"
		  (tap)="onPtButtonTapped()"></Button>
          <Button [class]="connected ? 'fa hero' : 'fa grayed'"
		  text="SmartDrive"
		  margin="0, 25, 0, 15"
		  (tap)="onSdButtonTapped()"></Button>
        </StackLayout>
      </StackLayout>

      //StackLayout in row 1 contains OTA title and descriptions
      <StackLayout   col="0" row="1" orientation="vertical" horizontalAlignment="center" padding="10">

        //OTA Title and version number
        <DockLayout>
          <Label class="title"
		 [text]="ptConnected ? initialTitleText : connectedTitleText"
		 textWrap="true"
		 dock="top"
		 stretchLastChild="true"></Label>
        </DockLayout>

        //OTA Descriptions
        <StackLayout #otaTitleView col="0" row="2" orientation="vertical" horizontalAlignment="center" padding="10">
	  <Label *ngFor="let desc of otaDescription" [text]="desc" class="otaDescription" textWrap="true"></Label>
          <Button class="hero"
		  [text]="updating ? updatingButtonText : initialButtonText"
		  margin="15"
		  (tap)="onStartOtaUpdate()"></Button>
        </StackLayout>
      </StackLayout>

      //StackLayout in row 2 contains progress views for updates
      <StackLayout #otaProgressView col="0" row="3" padding="5" orientation="vertical">
        //SmartDrive OTAs
        <StackLayout class="ota" *ngFor="let sd of smartDriveOTAs._array">
	  <GridLayout class="otaInfo" rows="auto" columns="auto, *">
            <Label col="0" class="otaLabel" text="SmartDrive"></Label>
            <Label col="1" class="percentageLabel" [text]="sd.otaProgress +'%'"></Label>
	  </GridLayout>
          <Progress [value]="sd.otaProgress" maxValue="100" class="progress"></Progress>
	  <GridLayout class="otaInfo" rows="auto, auto, *" columns="auto, *">
            <Label col="0" class="otaLabel" [text]="sd.address"></Label>
            <TextView col="0" row="1" editable="false" class="otaState" textDecoration="none" [text]="sd.otaStateToString()"></TextView>
	    <WrapLayout orientation="horizontal" horizontalAlignment="right" rowSpan="3" col="1">
              <Button *ngFor="let action of sd.otaActions" class="otaAction" [text]="action" (tap)="sd.onOTAActionTap(action)"></Button>
	    </WrapLayout>
	  </GridLayout>
	</StackLayout>
        //PushTracker OTAs
        <StackLayout class="ota" *ngFor="let pt of pushTrackerOTAs._array">
	  <GridLayout class="otaInfo" rows="auto" columns="auto, *">
            <Label col="0" class="otaLabel" text="PushTracker"></Label>
            <Label col="1" class="percentageLabel" [text]="pt.otaProgress +'%'"></Label>
	  </GridLayout>
          <Progress [value]="pt.otaProgress" maxValue="100" class="progress"></Progress>
	  <GridLayout class="otaInfo" rows="auto, auto, *" columns="auto, *">
            <Label col="0" class="otaLabel" [text]="pt.address"></Label>
            <TextView col="0" row="1" editable="false" class="otaState" textDecoration="none" [text]="pt.otaStateToString()"></TextView>
	    <WrapLayout orientation="horizontal" horizontalAlignment="right" rowSpan="3" col="1">
              <Button *ngFor="let action of pt.otaActions" class="otaAction" [text]="action" (tap)="pt.onOTAActionTap(action)"></Button>
	    </WrapLayout>
	  </GridLayout>
	</StackLayout>
      </StackLayout>

      //StackLayout in row 3 contains a view to display new features.
      //TODO: Create slideshow and ability to display video and text
      <StackLayout #otaFeaturesView class="featuresLayout" col="0" row="4" padding="5" orientation="vertical">

        <TextView class="features" editable="false" textWrap="true" text="Estimated drive range is a cool new feature in this update. Here's how it works-"></TextView>

      </StackLayout>
    </GridLayout>
  </ScrollView>
</RadSideDrawer>
